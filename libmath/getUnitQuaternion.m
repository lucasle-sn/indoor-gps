function e = getUnitQuaternion(C)
    e4 = 1/2 * sqrt(1 + C(1,1) + C(2,2)+ C(3,3));
    
    if (e4 ~= 0)
        e1 = -(C(3,2)-C(2,3))/(4*e4);
        e2 = -(C(1,3)-C(3,1))/(4*e4);
        e3 = -(C(2,1)-C(1,2))/(4*e4);
    else
        e1 = 1/2*sqrt(1+C(1,1)-C(2,2)-C(3,3));
        e2 = (C(1,2)+C(2,1))/(4*e1);
        e3 = (C(3,1)+C(1,3))/(4*e1);
        e4 = (C(2,3)-C(3,2))/(4*e1);
    end

    e = [e4;e1;e2;e3];
end
